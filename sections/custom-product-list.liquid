{% schema %}
{
  "name": "Custom Product List",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Featured Products"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Select Collection"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 4,
      "max": 12,
      "step": 1,
      "default": 8,
      "label": "Products to show"
    }
  ],
  "presets": [
    {
      "name": "Custom Product List"
    }
  ]
}
{% endschema %}

<section class="hk-section">
  <div class="page-width">

    <h2 class="hk-section-title">
      {{ section.settings.heading }}
    </h2>

    <div class="hk-grid">

      {% if section.settings.collection != blank %}

        {% for product in section.settings.collection.products limit: section.settings.products_to_show %}

        <div class="hk-card">

          <!-- Wishlist -->
          <div class="hk-wishlist">â™¡</div>

          <!-- Image -->
          <a href="{{ product.url }}" class="hk-image-link">
            <div class="hk-image-wrapper">
              <img 
                src="{{ product.featured_image | image_url: width: 600 }}" 
                alt="{{ product.title }}"
                loading="lazy">
            </div>
          </a>

          <!-- Info -->
          <div class="hk-info">

            <!-- Rating (Static Example â€“ Replace with review app if needed) -->
            <div class="hk-rating-row">
              <div class="hk-rating-badge">4.4 â˜…</div>
              <div class="hk-reviews">Popular</div>
            </div>

            <!-- Title -->
            <h3 class="hk-title">
              <a href="{{ product.url }}">
                {{ product.title }}
              </a>
            </h3>

            <!-- Price -->
            <div class="hk-price-block">

              <div class="hk-price-row">

                <span class="hk-price">
                  {{ product.price | money }}
                </span>

                {% if product.compare_at_price > product.price %}
                  <span class="hk-old-price">
                    {{ product.compare_at_price | money }}
                  </span>

                  <span class="hk-discount">
                    {{ product.compare_at_price | minus: product.price | times: 100 | divided_by: product.compare_at_price }}% off
                  </span>
                {% endif %}

              </div>

            </div>

            <!-- Buttons -->
            <div class="hk-buttons">

              <form method="post" action="/cart/add">
                <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
                <button type="submit" class="hk-add-to-cart">
                  ðŸ›’ Add to Cart
                </button>
              </form>

              <button class="hk-buy-now"
                onclick="window.location.href='{{ product.url }}'">
                Buy Now
              </button>

            </div>

          </div>

        </div>

        {% endfor %}

      {% else %}
        <p>Please select a collection in theme editor.</p>
      {% endif %}

    </div>

  </div>
</section>


<style>
.hk-section {
  padding: 60px 20px;
  background: #f8f8f8;
}

.hk-section-title {
  text-align: center;
  font-size: 30px;
  margin-bottom: 40px;
  font-weight: 600;
}

.hk-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 25px;
}

/* Card */
.hk-card {
  position: relative;
  background: #fff;
  border: 1px solid #e6e6e6;
  border-radius: 16px;
  padding: 18px;
  transition: 0.3s ease;
}

.hk-card:hover {
  box-shadow: 0 12px 30px rgba(0,0,0,0.08);
}

/* Wishlist */
.hk-wishlist {
  position: absolute;
  right: 18px;
  top: 18px;
  font-size: 18px;
  cursor: pointer;
}

/* Image */
.hk-image-wrapper {
  text-align: center;
  padding: 15px 0;
}

.hk-image-wrapper img {
  max-width: 100%;
  height: auto;
}

/* Rating */
.hk-rating-row {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 8px;
}

.hk-rating-badge {
  background: #1aa260;
  color: #fff;
  font-size: 13px;
  padding: 4px 8px;
  border-radius: 6px;
}

.hk-reviews {
  font-size: 13px;
  color: #555;
}

/* Title */
.hk-title {
  font-size: 15px;
  margin: 10px 0;
  line-height: 1.4;
  min-height: 42px;
}

.hk-title a {
  text-decoration: none;
  color: #333;
}

/* Pricing */
.hk-price-row {
  display: flex;
  align-items: center;
  gap: 8px;
}

.hk-price {
  font-size: 18px;
  font-weight: 600;
}

.hk-old-price {
  text-decoration: line-through;
  color: #888;
  font-size: 14px;
}

.hk-discount {
  color: #1aa260;
  font-size: 14px;
  font-weight: 500;
}

/* Buttons */
.hk-buttons {
  margin-top: 15px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.hk-add-to-cart {
  border: 2px solid #ff7a00;
  background: #fff;
  color: #ff7a00;
  padding: 10px;
  border-radius: 10px;
  cursor: pointer;
  font-weight: 600;
  transition: 0.2s;
}

.hk-add-to-cart:hover {
  background: #fff4ea;
}

.hk-buy-now {
  background: #ff7a00;
  color: #fff;
  border: none;
  padding: 11px;
  border-radius: 10px;
  font-weight: 600;
  cursor: pointer;
  transition: 0.2s;
}

.hk-buy-now:hover {
  background: #e86f00;
}

/* Responsive */

@media (max-width: 1200px) {
  .hk-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}

@media (max-width: 768px) {
  .hk-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 480px) {
  .hk-grid {
    grid-template-columns: 1fr;
  }
}
</style>